<html>
<head>
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">

    <!-- Optional theme -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap-theme.min.css" integrity="sha384-fLW2N01lMqjakBkx3l/M9EahuwpSfeNvV63J5ezn3uZzapT0u7EYsXMjQV+0En5r" crossorigin="anonymous">

    <script src="https://code.jquery.com/jquery-1.11.3.min.js"></script>

    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>

    <!-- Leaflet -->
    <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet/v0.7.7/leaflet.css" />
    <script src="http://cdn.leafletjs.com/leaflet/v0.7.7/leaflet.js"></script>

    <!-- Heatmap -->
    <script src="leaflet-heat.js"></script>

</head>

<body>
<div id="map" style="height: 100%"></div>
<script type="text/javascript">

    $( document ).ready(function() {
        var map = L.map('map', {'layers': []}).setView([49.0, 8.4], 13);

        CartoDB_Positron = L.tileLayer('http://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png', {
            attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> &copy; <a href="http://cartodb.com/attributions">CartoDB</a>',
            subdomains: 'abcd',
            maxZoom: 17
        }).addTo(map); // besser als esri

        var heat = L.heatLayer([], {
            minOpacity: 0.5, // cluster intensity -> size, area
            radius: 50, // bigger dots -> area
            blur: 75, // wider heatareas
            max: 2 // avoids red dots for one single startup
        }).addTo(map);

        $.getJSON( "data.json", function( data ) {
            for (var group_id in data) {
                var group = data[group_id];
                var locations = group.locations_approved;
                for (i = 0; i < locations.length; i++) {
                    var location = locations[i];
                    var geocode = location.geocode;
                    var coordinates = [geocode.latitude, geocode.longitude];
                    var popup_content = "<a href=\"" + location.url + "\" target=\"_blank\">" + location.title + "</a>" + " (" + group.name + ")";
                    heat.addLatLng(coordinates);
                }
            }
        });

        L.control.layers({'Graustufen': CartoDB_Positron}, {}).addTo(map);

    });
</script>
</body>
</html>